---
// FotoZoom2.astro - Foto 2 con animación elegante para boda
---

<section
    class="pb-10 relative w-full flex flex-col items-center justify-center overflow-hidden"
>
    <!-- Fondo con imagen ESTÁTICA -->
    <div class="relative w-full">
        <img
            id="parallax-image-31"
            src="/imagenes/foto3.1.webp"
            alt="Fotografía de boda"
            class="w-full h-auto opacity-0"
        />
        <div class="absolute inset-0 opacity-0" id="overlay-31"></div>
    </div>

    <!-- Partículas flotantes elegantes -->
    <div
        class="absolute inset-0 z-5 pointer-events-none"
        id="particles-container"
    >
        <div
            class="particle absolute top-[10%] left-[10%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[15%] right-[15%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[25%] left-[20%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[30%] right-[25%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[35%] left-[50%] w-2 h-2 bg-white/80 rounded-full shadow-[0_0_18px_rgba(255,255,255,1)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[40%] left-[15%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[45%] right-[10%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[50%] left-[30%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[55%] right-[35%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[60%] left-[45%] w-2 h-2 bg-white/80 rounded-full shadow-[0_0_18px_rgba(255,255,255,1)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[65%] right-[20%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[70%] left-[25%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[75%] right-[40%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[80%] left-[35%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[85%] right-[30%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[20%] left-[40%] w-2 h-2 bg-white/80 rounded-full shadow-[0_0_18px_rgba(255,255,255,1)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[48%] right-[50%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[62%] left-[60%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[38%] right-[45%] w-1 h-1 bg-white/60 rounded-full shadow-[0_0_12px_rgba(255,255,255,0.8)] opacity-0"
        >
        </div>
        <div
            class="particle absolute top-[72%] left-[55%] w-1.5 h-1.5 bg-white/70 rounded-full shadow-[0_0_15px_rgba(255,255,255,0.9)] opacity-0"
        >
        </div>
    </div>
</section>

<style>
    @keyframes float-elegant {
        0%,
        100% {
            transform: translate(0, 0);
            opacity: 0.7;
        }
        33% {
            transform: translate(-15px, -25px);
            opacity: 1;
        }
        66% {
            transform: translate(10px, 15px);
            opacity: 0.5;
        }
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    if (typeof window !== "undefined") {
        document.addEventListener("DOMContentLoaded", () => {
            const image = document.querySelector("#parallax-image-31");
            const overlay = document.querySelector("#overlay-31");
            const particles = document.querySelectorAll(".particle");

            // Estado inicial
            gsap.set(image, { opacity: 0 });
            gsap.set(overlay, { opacity: 0 });
            gsap.set(particles, { opacity: 0, scale: 0 });

            // Animación con ScrollTrigger
            ScrollTrigger.create({
                trigger: "#parallax-image-31",
                start: "top bottom",
                end: "top 20%",

                onEnter: () => {
                    const tl = gsap.timeline();

                    tl.to(
                        image,
                        {
                            opacity: 1,
                            duration: 2.5,
                            ease: "power2.out",
                        },
                        0,
                    )
                        .to(
                            overlay,
                            {
                                opacity: 1,
                                duration: 2,
                                ease: "power1.out",
                            },
                            0.3,
                        )
                        .to(
                            particles,
                            {
                                opacity: 1,
                                scale: 1,
                                duration: 1.5,
                                stagger: { each: 0.08, from: "random" },
                                ease: "power2.out",
                            },
                            0.8,
                        );

                    // Flotación continua
                    particles.forEach((particle, index) => {
                        gsap.to(particle, {
                            x: `${gsap.utils.random(-20, 20)}`,
                            y: `${gsap.utils.random(-30, 30)}`,
                            duration: gsap.utils.random(8, 12),
                            repeat: -1,
                            yoyo: true,
                            ease: "sine.inOut",
                            delay: index * 0.1,
                        });

                        gsap.to(particle, {
                            opacity: gsap.utils.random(0.4, 0.8),
                            duration: gsap.utils.random(3, 5),
                            repeat: -1,
                            yoyo: true,
                            ease: "sine.inOut",
                            delay: index * 0.15,
                        });
                    });
                },

                onLeaveBack: () => {
                    gsap.killTweensOf(particles);

                    const tl = gsap.timeline();

                    tl.to(particles, {
                        opacity: 0,
                        scale: 0,
                        duration: 0.6,
                        stagger: 0.03,
                        ease: "power2.in",
                    })
                        .to(
                            overlay,
                            { opacity: 0, duration: 0.5, ease: "power1.in" },
                            0,
                        )
                        .to(
                            image,
                            { opacity: 0, duration: 0.8, ease: "power2.in" },
                            0,
                        );
                },
            });
        });
    }
</script>
