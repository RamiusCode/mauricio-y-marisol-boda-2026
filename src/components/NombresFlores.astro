---
// src/components/InvitacionBoda.astro
const NOMBRE_1 = "Mauricio";
const NOMBRE_2 = "Marisol";
const FECHA_BODA = "17 de abril 2026";
---

<section
  class="relative w-full h-screen flex flex-col items-center justify-center overflow-hidden"
>
  <!-- Fondo con imagen -->
  <div class="absolute inset-0 z-[1]">
    <img
      id="parallax-image"
      src="/imagenes/foto1.webp"
      alt={`${NOMBRE_1} y ${NOMBRE_2}`}
      class="w-full h-full object-cover animate-[zoom-in_2s_ease-out] transition-transform duration-300 ease-out will-change-transform"
    />
    <div
      class="absolute inset-0 bg-black/40 animate-[fade-in_1.5s_ease-out] z-[2]"
    >
    </div>
  </div>

  <!-- Part√≠culas flotantes -->
  <!-- <div
    class="absolute inset-0 z-[5] pointer-events-none"
    id="particulas-container"
  >
    <div
      class="particle absolute top-[10%] left-[10%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_8s_ease-in-out_infinite]"
    >
    </div>
    <div
      class="particle absolute top-[15%] right-[15%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_10s_ease-in-out_infinite_0.3s]"
    >
    </div>
    <div
      class="particle absolute top-[25%] left-[20%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_7s_ease-in-out_infinite_0.6s]"
    >
    </div>
    <div
      class="particle absolute top-[30%] right-[25%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_9s_ease-in-out_infinite_0.9s]"
    >
    </div>
    <div
      class="particle absolute top-[35%] left-[50%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_11s_ease-in-out_infinite_1.2s]"
    >
    </div>
    <div
      class="particle absolute top-[40%] left-[15%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_8.5s_ease-in-out_infinite_1.5s]"
    >
    </div>
    <div
      class="particle absolute top-[45%] right-[10%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_10.5s_ease-in-out_infinite_1.8s]"
    >
    </div>
    <div
      class="particle absolute top-[50%] left-[30%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_9.5s_ease-in-out_infinite_2.1s]"
    >
    </div>
    <div
      class="particle absolute top-[55%] right-[35%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_7.5s_ease-in-out_infinite_2.4s]"
    >
    </div>
    <div
      class="particle absolute top-[60%] left-[45%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_8.8s_ease-in-out_infinite_2.7s]"
    >
    </div>
    <div
      class="particle absolute top-[65%] right-[20%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_10.2s_ease-in-out_infinite_3s]"
    >
    </div>
    <div
      class="particle absolute top-[70%] left-[25%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_9.8s_ease-in-out_infinite_3.3s]"
    >
    </div>
    <div
      class="particle absolute top-[75%] right-[40%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_7.8s_ease-in-out_infinite_3.6s]"
    >
    </div>
    <div
      class="particle absolute top-[80%] left-[35%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_11.5s_ease-in-out_infinite_3.9s]"
    >
    </div>
    <div
      class="particle absolute top-[85%] right-[30%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_8.2s_ease-in-out_infinite_4.2s]"
    >
    </div>
    <div
      class="particle absolute top-[20%] left-[40%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_9.2s_ease-in-out_infinite_4.5s]"
    >
    </div>
    <div
      class="particle absolute top-[48%] right-[50%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_10.8s_ease-in-out_infinite_4.8s]"
    >
    </div>
    <div
      class="particle absolute top-[62%] left-[60%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_7.2s_ease-in-out_infinite_5.1s]"
    >
    </div>
    <div
      class="particle absolute top-[38%] right-[45%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_11.2s_ease-in-out_infinite_5.4s]"
    >
    </div>
    <div
      class="particle absolute top-[72%] left-[55%] w-3 h-3 bg-white rounded-full shadow-[0_0_20px_rgba(255,255,255,1)] animate-[float_8.6s_ease-in-out_infinite_5.7s]"
    >
    </div>
  </div> -->

  <!-- Contenido principal -->
  <div
    class="relative z-[10] text-center px-6 flex flex-col items-center h-full"
  >
    <!-- Subt√≠tulo en la parte superior -->
    <p
      class="font-charm text-white/90 text-2xl md:text-base uppercase mt-8 font-light animate-[slide-down_1.5s_ease-out_0.2s_both]"
    >
      Nuestra Boda
    </p>

    <!-- Espaciador flexible -->
    <div class="flex-grow"></div>

    <!-- Nombres -->
    <div class="mb-4 space-y-4">
      <h1
        class="font-great-vibes text-6xl md:text-7xl lg:text-8xl text-white drop-shadow-[0_4px_20px_rgba(0,0,0,0.5)] leading-tight italic font-light animate-[slide-up_1.5s_ease-out_0.2s_both]"
      >
        {NOMBRE_1}
      </h1>

      <!-- Separador -->
      <div class="flex items-center justify-center gap-4 py-2">
        <div
          class="h-px w-12 md:w-16 bg-white/60 animate-[expand-right_1s_ease-out_0.2s_both] origin-right"
        >
        </div>
        <span
          class="font-great-vibes text-5xl md:text-5xl text-white/90 font-serif animate-[scale-in_1s_ease-out_0.2s_both]"
          >&</span
        >
        <div
          class="h-px w-12 md:w-16 bg-white/60 animate-[expand-left_1s_ease-out_0.2s_both] origin-left"
        >
        </div>
      </div>

      <h1
        class="font-great-vibes text-6xl md:text-7xl lg:text-8xl text-white drop-shadow-[0_4px_20px_rgba(0,0,0,0.5)] leading-tight italic font-light animate-[slide-up_1.5s_ease-out_0.2s_both]"
      >
        {NOMBRE_2}
      </h1>
    </div>

    <!-- Fecha -->
    <div
      class="mb-20 flex items-center gap-3 px-6 py-3 rounded-full border border-white/40 backdrop-blur-sm bg-white/10 animate-[slide-up_1.2s_ease-out_0.7s_both] relative overflow-hidden"
    >
      <div
        class="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent animate-[shimmer_3s_ease-in-out_infinite] -translate-x-full"
      >
      </div>

      <svg
        class="w-5 h-5 text-white/80 animate-[fade-in-left_0.8s_ease-out_0.9s_both] relative z-10"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
        ></path>
      </svg>

      <p
        class="text-white text-base md:text-lg tracking-wider font-light animate-[fade-in_0.6s_ease-out_0.9s_both] relative z-10"
      >
        {FECHA_BODA}
      </p>

      <svg
        class="w-5 h-5 text-white/80 animate-[fade-in-right_0.8s_ease-out_0.9s_both] relative z-10"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
        ></path>
      </svg>
    </div>
  </div>

  <!-- Indicador de scroll -->
  <div
    class="absolute bottom-8 left-1/2 -translate-x-1/2 z-[10] animate-[bounce-slow_2s_ease-in-out_infinite_1.2s]"
  >
    <svg
      class="w-6 h-6 text-white/60"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
    </svg>
  </div>

  <!-- üéµ BOT√ìN FLOTANTE DE M√öSICA -->
  <div class="fixed bottom-6 right-6 z-[9999]" id="boton-musica-flotante">
    <button
      id="toggle-musica-global"
      class="group relative w-14 h-14 bg-white/80 hover:bg-white/90 backdrop-blur-md rounded-full shadow-lg hover:shadow-2xl flex items-center justify-center transition-all duration-200 hover:scale-110 active:scale-95 border border-white/40"
      aria-label="Controlar m√∫sica"
    >
      <div
        class="absolute inset-0 rounded-full bg-gradient-to-tr from-transparent via-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200"
      >
      </div>

      <!-- ICONO PAUSE - INICIA VISIBLE -->
      <svg
        id="icono-pause-global"
        class="w-6 h-6 text-[#0F3D2E] relative z-10 transition-all duration-100"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          d="M5.5 3.5A1.5 1.5 0 017 2h1a1.5 1.5 0 011.5 1.5v13A1.5 1.5 0 018 18H7a1.5 1.5 0 01-1.5-1.5v-13zm7 0A1.5 1.5 0 0114 2h1a1.5 1.5 0 011.5 1.5v13a1.5 1.5 0 01-1.5 1.5h-1a1.5 1.5 0 01-1.5-1.5v-13z"
        ></path>
      </svg>

      <!-- ICONO PLAY - INICIA OCULTO -->
      <svg
        id="icono-play-global"
        class="w-6 h-6 text-[#0F3D2E] hidden relative z-10 transition-all duration-100"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          d="M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"
        ></path>
      </svg>

      <!-- Ondas de sonido - INICIA VISIBLE -->
      <div
        class="absolute -inset-2 rounded-full border-2 border-white/40 animate-ping-slow"
        id="onda-sonido"
      >
      </div>
    </button>
  </div>
</section>

<style>
  @keyframes zoom-in {
    from {
      transform: scale(1.2);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }

  @keyframes fade-in {
    from {
      opacity: 0;
      filter: blur(4px);
    }
    to {
      opacity: 1;
      filter: blur(0);
    }
  }

  @keyframes scale-in {
    from {
      transform: scale(0) rotate(-20deg);
      opacity: 0;
      filter: blur(8px);
    }
    to {
      transform: scale(1) rotate(0deg);
      opacity: 1;
      filter: blur(0);
    }
  }

  @keyframes slide-down {
    from {
      transform: translateY(-40px);
      opacity: 0;
      letter-spacing: 0.6em;
      filter: blur(8px);
    }
    to {
      transform: translateY(0);
      opacity: 1;
      letter-spacing: normal;
      filter: blur(0);
    }
  }

  @keyframes slide-up {
    from {
      transform: translateY(60px) scale(0.9);
      opacity: 0;
      filter: blur(10px);
    }
    to {
      transform: translateY(0) scale(1);
      opacity: 1;
      filter: blur(0);
    }
  }

  @keyframes expand-right {
    from {
      transform: scaleX(0);
      opacity: 0;
    }
    to {
      transform: scaleX(1);
      opacity: 1;
    }
  }

  @keyframes expand-left {
    from {
      transform: scaleX(0);
      opacity: 0;
    }
    to {
      transform: scaleX(1);
      opacity: 1;
    }
  }

  @keyframes fade-in-left {
    from {
      transform: translateX(-20px);
      opacity: 0;
      filter: blur(4px);
    }
    to {
      transform: translateX(0);
      opacity: 1;
      filter: blur(0);
    }
  }

  @keyframes fade-in-right {
    from {
      transform: translateX(20px);
      opacity: 0;
      filter: blur(4px);
    }
    to {
      transform: translateX(0);
      opacity: 1;
      filter: blur(0);
    }
  }

  @keyframes bounce-slow {
    0%,
    100% {
      transform: translateY(0);
      opacity: 0.6;
    }
    50% {
      transform: translateY(10px);
      opacity: 1;
    }
  }

  @keyframes float {
    0%,
    100% {
      transform: translate(0, 0) scale(1);
      opacity: 0.6;
    }
    25% {
      transform: translate(-20px, -30px) scale(1.2);
      opacity: 0.8;
    }
    50% {
      transform: translate(15px, 20px) scale(0.9);
      opacity: 0.4;
    }
    75% {
      transform: translate(-10px, 35px) scale(1.3);
      opacity: 0.7;
    }
  }

  @keyframes shimmer {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(200%);
    }
  }

  @keyframes ping-slow {
    0% {
      transform: scale(1);
      opacity: 0.5;
    }
    75%,
    100% {
      transform: scale(1.3);
      opacity: 0;
    }
  }

  .animate-ping-slow {
    animation: ping-slow 2s cubic-bezier(0, 0, 0.2, 1) infinite;
  }

  @keyframes pulse-subtle {
    0%,
    100% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
  }

  #boton-musica-flotante button {
    animation: pulse-subtle 3s ease-in-out infinite;
  }

  #boton-musica-flotante button:hover {
    animation: none;
  }
</style>

<script>
  import { gsap } from "gsap";

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // EFECTO PARALLAX SUAVE
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  const parallaxImage = document.getElementById("parallax-image");

  let currentScroll = 0;
  let targetScroll = 0;
  let animationId = null;

  function lerp(start: number, end: number, factor: number): number {
    return start + (end - start) * factor;
  }

  function smoothParallax() {
    currentScroll = lerp(currentScroll, targetScroll, 0.08);

    if (parallaxImage) {
      parallaxImage.style.transform = `translateY(${currentScroll * 0.3}px) scale(1)`;
    }

    if (Math.abs(targetScroll - currentScroll) > 0.5) {
      animationId = requestAnimationFrame(smoothParallax);
    } else {
      animationId = null;
    }
  }

  window.addEventListener(
    "scroll",
    () => {
      targetScroll = window.scrollY;
      if (!animationId) {
        animationId = requestAnimationFrame(smoothParallax);
      }
    },
    { passive: true },
  );

  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // üéµ BOT√ìN FLOTANTE DE M√öSICA
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

  document.addEventListener("DOMContentLoaded", () => {
    console.log("üéµ Inicializando bot√≥n de m√∫sica flotante...");

    const botonToggle = document.getElementById("toggle-musica-global");
    const iconoPlay = document.getElementById("icono-play-global");
    const iconoPause = document.getElementById("icono-pause-global");
    const ondaSonido = document.getElementById("onda-sonido");
    const particulasContainer = document.getElementById("particulas-container");

    // ‚ïê‚ïê‚ïê ANIMACI√ìN DE ENTRADA DE PART√çCULAS ‚ïê‚ïê‚ïê
    if (particulasContainer) {
      gsap.set(particulasContainer, { opacity: 0 });

      // Esperar un momento antes de mostrar las part√≠culas
      gsap.to(particulasContainer, {
        opacity: 1,
        duration: 2,
        delay: 0.5,
        ease: "power2.out",
      });
    }

    // ‚ïê‚ïê‚ïê ANIMACI√ìN DE ENTRADA DEL BOT√ìN ‚ïê‚ïê‚ïê
    gsap.fromTo(
      "#boton-musica-flotante",
      { opacity: 0, scale: 0, rotation: -180 },
      {
        opacity: 1,
        scale: 1,
        rotation: 0,
        duration: 0.8,
        ease: "back.out(1.7)",
        delay: 1.5,
      },
    );

    // ‚ïê‚ïê‚ïê TOGGLE AL HACER CLIC - TRANSICIONES R√ÅPIDAS ‚ïê‚ïê‚ïê
    botonToggle?.addEventListener("click", () => {
      const audioActual = (window as any).audioGlobal;
      const estadoActual = (window as any).estaReproduciendoGlobal;

      if (estadoActual && audioActual) {
        // PAUSAR M√öSICA
        audioActual.pause();
        (window as any).estaReproduciendoGlobal = false;

        // Cambio INSTANT√ÅNEO de iconos
        iconoPause?.classList.add("hidden");
        iconoPlay?.classList.remove("hidden");
        ondaSonido?.classList.add("hidden");

        console.log("‚è∏Ô∏è M√∫sica pausada");
      } else if (audioActual) {
        // REPRODUCIR M√öSICA
        audioActual.play().catch((error: any) => {
          console.log("‚ùå Error al reproducir:", error);
        });
        (window as any).estaReproduciendoGlobal = true;

        // Cambio INSTANT√ÅNEO de iconos
        iconoPlay?.classList.add("hidden");
        iconoPause?.classList.remove("hidden");
        ondaSonido?.classList.remove("hidden");

        console.log("‚ñ∂Ô∏è M√∫sica reproduci√©ndose");
      }
    });

    console.log("‚úÖ Bot√≥n de m√∫sica flotante listo!");
  });
</script>
